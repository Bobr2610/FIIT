# Документация API

## Обзор
Этот документ предоставляет подробную документацию для конечных точек REST API. API разработан с использованием Django REST Framework и предоставляет функциональность для управления пользователями, операций с портфелями и отслеживания валют.

## Аутентификация
Все конечные точки защищены базовой аутентификацией (Basic Authentication). Вы должны включить действительные учетные данные аутентификации в заголовок запроса.

```
Authorization: Basic <учетные-данные-в-base64>
```

## Интерфейсы документации API
- Swagger UI: `/swagger/` - Интерактивная документация API
- ReDoc: `/redoc/` - Альтернативный интерфейс документации

## Доступные конечные точки

### Управление пользователями
**Конечная точка**: `/api/users/`
- **GET**: Получение списка пользователей или информации о конкретном пользователе
- **POST**: Создание нового пользователя
- **PUT/PATCH**: Обновление информации о пользователе
- **DELETE**: Удаление пользователя

Обязательные поля:
- username (строка) - имя пользователя
- email (строка) - электронная почта

### Управление аккаунтами
**Конечная точка**: `/api/accounts/`
- **GET**: Получение списка аккаунтов или информации о конкретном аккаунте
- **POST**: Создание нового аккаунта
- **PUT/PATCH**: Обновление информации об аккаунте
- **DELETE**: Удаление аккаунта

Обязательные поля:
- username (строка) - имя пользователя
- email (строка) - электронная почта
- telegram (строка) - ссылка на Telegram пользователя

### Операции с портфелями
**Конечная точка**: `/api/portfolios/`
- **GET**: Получение портфелей пользователя или информации о конкретном портфеле
- **POST**: Создание нового портфеля
- **PUT/PATCH**: Обновление информации о портфеле
- **DELETE**: Удаление портфеля

Обязательные поля:
- account (целое число, ID аккаунта) - идентификатор аккаунта, которому принадлежит портфель

### Торговые операции
**Конечная точка**: `/api/operations/`
- **GET**: Получение торговых операций
- **POST**: Создание новой торговой операции
- **PUT/PATCH**: Обновление деталей операции
- **DELETE**: Удаление операции

Обязательные поля:
- portfolio (целое число, ID портфеля) - идентификатор портфеля, в котором совершается операция
- operation_type (строка, "BUY"/"SELL") - тип операции (покупка/продажа)
- product (строка) - название финансового инструмента
- amount (целое число) - количество единиц
- price (целое число) - цена за единицу

### Информация о валютах
**Конечная точка**: `/api/currencies/` (Только для чтения)
- **GET**: Получение доступных валют

Поля:
- name (строка) - полное название валюты
- short_name (строка) - краткое обозначение валюты

### Исторические данные о валютах
**Конечная точка**: `/api/currency-history/` (Только для чтения)
- **GET**: Получение исторических данных о валютах

Поля:
- currency (целое число, ID валюты) - идентификатор валюты

### Курсы валют
**Конечная точка**: `/api/rates/` (Только для чтения)
- **GET**: Получение текущих курсов валют

Поля:
- cost (десятичное число) - стоимость валюты
- timestamp (дата и время) - время последнего обновления курса

## Начало работы

1. Убедитесь, что у вас есть учетные данные для аутентификации
2. Получите доступ к Swagger UI по адресу `/swagger/` или ReDoc по адресу `/redoc/` для интерактивной документации
3. Используйте соответствующую конечную точку для ваших нужд
4. Включите аутентификацию в ваши запросы
5. Обрабатывайте ответы в соответствии с кодами состояния HTTP

## Форматы ответов
Все ответы возвращаются в формате JSON. Успешные ответы будут иметь соответствующие коды состояния HTTP (200 для GET, 201 для POST и т.д.).

Пример успешного ответа:
```json
{
    "id": 1,
    "username": "example_user",
    "email": "user@example.com"
}
```

Ответы с ошибками будут включать соответствующие коды состояния и сообщения об ошибках:
```json
{
    "error": "Учетные данные аутентификации не были предоставлены."
}
```

## Ограничение скорости запросов
Запросы API подлежат ограничению скорости. Пожалуйста, корректно обрабатывайте ответы 429 Too Many Requests (Слишком много запросов).

## Безопасность
- Все конечные точки требуют аутентификации
- Используйте HTTPS для всех запросов
- Храните ваши учетные данные аутентификации в безопасности
- Не делитесь вашими API-токенами

## Примеры использования API

### Пример получения списка пользователей
```python
import requests
from base64 import b64encode

# Учетные данные для аутентификации
username = 'admin'
password = 'password'

# Кодирование учетных данных в base64
auth_string = f"{username}:{password}"
auth_bytes = auth_string.encode('ascii')
auth_b64 = b64encode(auth_bytes).decode('ascii')

# Заголовок с аутентификацией
headers = {
    'Authorization': f'Basic {auth_b64}'
}

# Запрос на получение списка пользователей
response = requests.get('http://example.com/api/users/', headers=headers)

# Вывод результата
if response.status_code == 200:
    users = response.json()
    for user in users:
        print(f"Пользователь: {user['username']}, Email: {user['email']}")
else:
    print(f"Ошибка: {response.status_code}")
    print(response.json())
```

### Пример создания новой торговой операции
```python
import requests
from base64 import b64encode

# Учетные данные для аутентификации
username = 'admin'
password = 'password'

# Кодирование учетных данных в base64
auth_string = f"{username}:{password}"
auth_bytes = auth_string.encode('ascii')
auth_b64 = b64encode(auth_bytes).decode('ascii')

# Заголовок с аутентификацией
headers = {
    'Authorization': f'Basic {auth_b64}',
    'Content-Type': 'application/json'
}

# Данные для создания новой операции
data = {
    'portfolio': 1,  # ID портфеля
    'operation_type': 'BUY',  # Тип операции (покупка)
    'product': 'USD',  # Название финансового инструмента
    'amount': 100,  # Количество единиц
    'price': 75  # Цена за единицу
}

# Запрос на создание новой операции
response = requests.post('http://example.com/api/operations/', json=data, headers=headers)

# Вывод результата
if response.status_code == 201:
    operation = response.json()
    print(f"Операция создана: {operation}")
else:
    print(f"Ошибка: {response.status_code}")
    print(response.json())
```